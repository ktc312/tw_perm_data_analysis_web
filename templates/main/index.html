<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Taiwanese PERM Statistics</title>

    <!-- Bootstrap core CSS -->
    {% load static from staticfiles %}
    <link rel="stylesheet" href="{% static 'assets/css/bootstrap.css' %}">
    <!-- Custom styles for this template -->
    {% load static from staticfiles %}
    <link rel="stylesheet" href="{% static 'assets/css/custom-animations.css' %}">
    {% load static from staticfiles %}
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">



    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    {% load static from staticfiles %}
    <script type="text/javascript" src="{% static "assets/js/ie10-viewport-bug-workaround.js" %}"></script>


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

	<! -- ********** HEADER ********** -->
	<div id="h">
		<div class="container">
			<div class="row">
                <div>
                    <button class="btn btn-lg btn-info btn-register" id="qa_button" href="QA">
                    What's PERM?</button>
                </div>
			    <div class="col-md-10 col-md-offset-1 mt">
			    	<h3>Taiwanese PERM Statistics</h3>
			    	<h1 class="mb">台灣人 PERM 薪資統計</h1>
			    </div>
			    <div class="col-md-12 mt hidden-xs">
                    <img src="{% static "assets/img/graph.png" %}" class="img-responsive aligncenter" alt=""
                         data-effect="slide-bottom">
			    </div>
			</div>
		</div><! --/container -->
	</div><! --/h -->

	<! -- ********** FIRST ********** -->
	<div id="w">
		<div class="row nopadding">
			<div class="col-md-5 col-md-offset-1 mt">
				<h4>Top 10 Companies</h4>
				<p>2007 年 10 月至 {{ end_year }} 年 {{ end_mon }} 月，共有 {{ total_perm }} PERM 案件資料，
                    其中 {{ approved_perm }} 件通過審查。</p>
				<p>以下為前十最多申請件數的公司：</p>
				<table class="top_10_tables">
                    <tr>
                        <th>公司</th><th>件數</th><th>比例</th>
                    </tr>
                    {% for label in top_10_com_count %}
                        <tr >
                            <td>{{ label.0 }}</td><td>{{ label.1 }}</td><td>{{ label.2 }}</td>
                        </tr>
                    {% endfor %}
                </table>
				<p class="mt"><button class="btn btn-info btn-theme" id="more_1">more</button></p>
			</div>

			<div class="col-md-6 pull-right">
                <div id="top_10_com_donut" class="img-responsive aligncenter" alt="" data-effect="slide-right"></div>
			</div>
		</div><! --/row -->
	</div><! --/container -->


	<! -- ********** BLUE SECTION - PICTON ********** -->
	<div id="picton">
		<div class="row nopadding">
			<div class="col-md-6 pull-left" style="margin-top: 100px;">
                <div id="top_10_state_donut" class="img-responsive aligncenter" alt="" data-effect="slide-left"></div>
			</div>
			<div class="col-md-5 mt">
				<h4>Top 10 States</h4>
				<p>2007 年 10 月至 {{ end_year }} 年 {{ end_mon }} 月，共有 {{ total_perm }} PERM 案件資料，
                    其中 {{ approved_perm }} 件通過審查。</p>
				<p>以下為前十最多申請件數的州：</p>
                <table class="top_10_tables">
                    <tr>
                        <th>州</th><th>件數</th><th>比例</th>
                    </tr>
                    {% for label in top_10_state_count %}
                        <tr >
                            <td>{{ label.0 }}</td><td>{{ label.1 }}</td><td>{{ label.2 }}</td>
                        </tr>
                    {% endfor %}
                </table>
				<p class="mt"><button class="btn btn-white btn-theme" id="more_2">more</button></p>
			</div>

		</div><! --row -->
	</div><! --/Picton -->


	<! -- ********** BLUE SECTION - CURIOUS ********** -->
	<div id="curious">
		<div class="row nopadding">
			<div class="col-md-5 col-md-offset-1 mt">
				<h4>Salary Distribution in New York Metro Area</h4>
				<p>2007 年 10 月至 {{ end_year }} 年 {{ end_mon }} 月，共有 {{ approved_perm }} 件 PERM 案件通過審查，
                    其中 {{ ny_perm }} 件來自大紐約地區。</p>
                <p>以下為大紐約地區的概括統計：</p>
                <table class="top_10_tables">
                    <tr>
                        <th> </th><th>薪資</th>
                    </tr>
                    <tr>
                        <td>平均數</td><td>{{ ny_mean }}</td>
                    </tr>
                    <tr>
                        <td>中位數</td><td>{{ ny_median }}</td>
                    </tr>
                    <tr>
                        <td>標準差</td><td>{{ ny_std }}</td>
                    </tr>
                    <tr>
                        <td>最低</td><td>{{ ny_min }}</td>
                    </tr>
                    <tr>
                        <td>最高</td><td>{{ ny_max }}</td>
                    </tr>
                </table>
                <p class="mt"><button class="btn btn-white btn-theme" id="more_3">more</button></p>
			</div>

			<div class="col-md-6 pull-right">
                <div id="NY_bar" class="img-responsive aligncenter" alt="" data-effect="slide-right"></div>
			</div>
		</div><! --/row -->
	</div><! --/curious -->

	<! -- ********** BLUE SECTION - MALIBU ********** -->
	<div id="malibu">
		<div class="row nopadding">
			<div class="col-md-6 pull-left">
                <div id="Year_line" class="img-responsive aligncenter" alt="" data-effect="slide-left"></div>
			</div>
			<div class="col-md-5 mt">
				<h4>Salary Distribution by Year</h4>
				<p>2007 年 10 月至 {{ end_year }} 年 {{ end_mon }} 月，共有 {{ approved_perm }} 件 PERM 案件通過審查，
                    左圖為歷年平均薪資。</p>
                <p class="mt"><button class="btn btn-white btn-theme" id="more_4">more</button></p>
			</div>

		</div><! --row -->
	</div><! --/Malibu -->


	<! -- ********** BLUE SECTION - JELLY ********** -->
	<div id="jelly">
		<div class="row nopadding">
			<div class="col-md-5 col-md-offset-1 mt">
				<h4>Salary Distribution by State</h4>
				<p>2007 年 10 月至 {{ end_year }} 年 {{ end_mon }} 月，共有 {{ approved_perm }} 件 PERM 案件通過審查。</p>
                <p>以下為薪資中位數最高的前十州：</p>
                <table class="top_10_tables">
                    <tr>
                        <th>州</th><th>薪資平均數</th><th>薪資中位數</th>
                    </tr>
                    {% for label in top_10_state_mean %}
                        <tr >
                            <td>{{ label.0 }}</td><td>{{ label.1 }}</td><td>{{ label.2 }}</td>
                        </tr>
                    {% endfor %}
                </table>
                <p class="mt"><button class="btn btn-white btn-theme" id="more_5">more</button></p>
			</div>

			<div class="col-md-6 mt centered" style="margin-top: 150px;">
				<h1 data-effect="slide-bottom">$ {{ top_state_median }}</h1>
				<h3>最高中位數： {{ top_state_name }}</h3>
			</div>
		</div><! --/row -->
	</div><! --/Jelly -->

	<! -- ********** FOOTER ********** -->
	<div id="c">
		<div class="container">
			<div class="row">
				<div class="col-md-6 col-md-offset-3 centered">
					<p>
                        Made by  K.T. Chang | <a href="mailto:ktc312@nyu.edu">ktc312@nyu.edu</a>
                    </p>
                    <p>
                        資料來源 <a href="http://visadoor.com">visadoor</a> | <a href="https://goo.gl/Djp8Rx">原始資料</a> |
                        <a href="https://github.com/ktc312/tw_perm_data_analysis_web">open source</a>
                    </p>
                    <p> 上次更新時間： {{ last_update_time }} </p>
				</div>
			</div>
		</div><! --/container -->
	</div><! --/C -->
    <a style="display: none" id="to_QA" href="/QA"></a>
    <a style="display: none" id="to_working" href="/working"></a>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    {% load static from staticfiles %}
    <script type="text/javascript" src="{% static "assets/js/jquery.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/bootstrap.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/retina-1.1.0.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/jquery.unveilEffects.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/raphael-min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/jquery-1.8.2.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/morris-0.4.1.min.js" %}"></script>
    <script type="text/javascript">

        window.onload = init;

        function init(){
            var qa_button = document.getElementById("qa_button");
            var more_1 = document.getElementById("more_1");
            var more_2 = document.getElementById("more_2");
            var more_3 = document.getElementById("more_3");
            var more_4 = document.getElementById("more_4");
            var more_5 = document.getElementById("more_5");
            qa_button.onclick = to_qa_page;
            more_1.onclick = to_working_page;
            more_2.onclick = to_working_page;
            more_3.onclick = to_working_page;
            more_4.onclick = to_working_page;
            more_5.onclick = to_working_page;
        }
        function to_qa_page() {
            document.getElementById('to_QA').click();
        }
        function to_working_page() {
            document.getElementById('to_working').click();
        }

        var com_graph = Morris.Donut({
            element: 'top_10_com_donut',
            data: [
                {% for label in top_10_com_count %}
                    { label: '{{ label.0 }}', value: {{ label.1 }} },
                {% endfor %}
            ]
        });

        var state_graph = Morris.Donut({
            element: 'top_10_state_donut',
            data: [
                {% for label in top_10_state_count %}
                    { label: '{{ label.0 }}', value: {{ label.1 }} },
                {% endfor %}
            ],
            backgroundColor: '#59ABE3',
            labelColor: '#fff',
            colors: ['#145214',
                     '#196619',
                     '#1f7a1f',
                     '#248f24',
                     '#29a329',
                     '#2eb82e',
                     '#47d147',
                     '#5cd65c',
                     '#70db70',
                     '#85e085']
        });

        var ny_bar = Morris.Bar({
            element: 'NY_bar',
            data: [
                    {% for label in ny_salary_dis %}
                        { y: "{{ label.0 }}", a: {{ label.1 }} },
                    {% endfor %}
            ],
            xkey: ['y'],
            ykeys: ['a'],
            gridTextColor: '#fff',
            gridLineColor:'#fff',
            labels: ['人數'],
            barColors: ['#196619'],
            xLabelMargin: 50
        });

        var year_line = Morris.Line({
            element: 'Year_line',
            data: [
                    {% for label in years_mean_median %}
                        { y: "{{ label.0 }}", a: {{ label.1 }}, b:{{ label.2 }} },
                    {% endfor %}
            ],
            xkey: 'y',
            ykeys: ['a', 'b'],
            gridTextColor: '#fff',
            gridLineColor:'#fff',
            labels: ['平均', '中位數'],
            xLabels: "year"
        });
    </script>
  </body>
</html>
